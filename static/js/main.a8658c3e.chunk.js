(this["webpackJsonpjob-report-react"]=this["webpackJsonpjob-report-react"]||[]).push([[0],{58:function(e,t,n){e.exports=n(69)},63:function(e,t,n){},67:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(8),o=n.n(l),c=(n(63),n(30)),i=n(115),u=n(118),s=n(117),m=(n(67),n(41)),f=n(114),d=n(111),p=n(113),E=n(108),g=n(110),h=n(112),v=n(106),b=n(116),y=n(109),S=n(104),O=Object(S.a)((function(e){return{table:{minWidth:300,maxWidth:700},container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:200}}})),w=function(e){var t=e.record,n=e.staff_list,l=O(),o=Object(a.useState)(function(){var e=new Date,t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDay()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(a)}()),c=Object(m.a)(o,2),i=c[0],u=c[1];return r.a.createElement("div",null,r.a.createElement(s.a,{display:"flex",justifyContent:"center"},r.a.createElement("form",{className:l.container,noValidate:!0},r.a.createElement(b.a,{id:"date",label:"ORDER DATE",type:"date",value:i,className:l.textField,onChange:function(e){return function(e){u(e.target.value)}(e)},InputLabelProps:{shrink:!0}}))),r.a.createElement(g.a,{component:y.a},r.a.createElement(s.a,{display:"flex",justifyContent:"center"},r.a.createElement(d.a,{className:l.table,size:"small"},r.a.createElement(h.a,null,r.a.createElement(v.a,null,r.a.createElement(E.a,null,"Staff Name"),r.a.createElement(E.a,null,"No of Response"))),r.a.createElement(p.a,null,function(){var e=t.slice(1,t.length);console.log(e);var a=e.filter((function(e){return function(e,t){try{var n=new Date(e);n.setHours(0,0,0,0);var a=new Date(t);return a.setHours(0,0,0,0),n.getTime()===a.getTime()}catch(r){throw r}}(e.orderDate,i)})),l=n.map((function(e){return{name:e,response:0}}));a.forEach((function(e){l.forEach((function(t){t.name===e.name&&t.response++}))})),l.sort((function(e,t){return t.response-e.response}));var o=(100*l.filter((function(e){return e.response>0})).length/l.length).toFixed(2);return l.unshift({name:"Response Rate",response:"".concat(o,"%")}),l.map((function(e){return r.a.createElement(v.a,{key:e.name},r.a.createElement(E.a,null,e.name),r.a.createElement(E.a,null,e.response))}))}())))))},k=function(e,t){for(var n=[],a=0;a<e.length;++a)n.push({}),n[a].name=e[a][2],n[a].orderDate=e[a][1];for(var r=0;r<t.length;++r)n.push({}),n[e.length+r].name=t[r][1],n[e.length+r].orderDate=t[r][3];return n},D=function(e){var t=e.old_sheet_id,n=e.new_sheet_id,l=e.report_range,o=e.staff_list_range,i=Object(a.useState)(!1),s=Object(m.a)(i,2),d=s[0],p=s[1];return r.a.createElement("div",null,r.a.createElement(u.a,{onClick:function(){return p(!d)}},"Reload Data"),r.a.createElement(c.a,{range:o,id:t},(function(e){var a=e.loading,o=e.error,i=e.data;return a?r.a.createElement("div",null,r.a.createElement(f.a,null),r.a.createElement("h5",null,"Getting Staff List from Google Sheet")):o?r.a.createElement("p",null,JSON.stringify(o,null,2)):i?r.a.createElement(c.a,{id:t,range:l},(function(e){var t=e.loading,a=e.error,o=e.data;return t?r.a.createElement("div",null,r.a.createElement(f.a,null),r.a.createElement("h5",null,"Getting Job Report from Google Sheet")):a?r.a.createElement("p",null,JSON.stringify(a,null,2)):o?r.a.createElement(c.a,{id:n,range:l},(function(e){var t=e.loading,n=e.error,a=e.data;return t?r.a.createElement("div",null,r.a.createElement(f.a,null),r.a.createElement("h5",null,"Getting New Job Report from Google Sheet")):n?r.a.createElement("p",null,JSON.stringify(n,null,2)):a?r.a.createElement(w,{record:k(o,a),staff_list:i.map((function(e){return e[0]}))}):r.a.createElement("p",null,"No Job Report Data")})):r.a.createElement("p",null,"No Job Report Data")})):r.a.createElement("p",null,"No Staff List Data")})))},N=n(22),_=n(23),j=n(24),J=n(25),R=function(e){Object(J.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(N.a)(this,n),(a=t.call(this,e)).state={hasError:!1},a}return Object(_.a)(n,[{key:"componentDidCatch",value:function(e,t){console.log(e),console.log(JSON.stringify(t))}},{key:"render",value:function(){return this.state.hasError?r.a.createElement("h1",null,"Something went wrong."):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),n}(r.a.Component),C=function(e){var t=e.clientId,n=e.apiKey;return r.a.createElement(c.b,{clientId:t,apiKey:n},(function(e){var t=e.authorize,n=e.loading,a=e.signout,l=e.signedIn,o=e.error;return r.a.createElement("div",null,n?r.a.createElement(i.a,null):o?r.a.createElement("div",null,JSON.stringify(o,null,2)):l?r.a.createElement(u.a,{variant:"contained",color:"secondary",onClick:a},"Sign Out"):r.a.createElement(u.a,{variant:"contained",color:"primary",onClick:t},"Authorize"),l&&r.a.createElement(D,{staff_list_range:"Staff_List!A1:A",report_range:"\u8868\u55ae\u56de\u61c9 1!A1:D",old_sheet_id:"1R9ti3zfqMCA9Cq3JjZAlfkIGMh6iC3atIlXN6aNKq8E",new_sheet_id:"1U4OA8kJ9ROdMKOrC3oA6-sBK1a91HqOPEgk9FpsGn9Y"}))}))};var x=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(R,null,r.a.createElement(s.a,{display:"flex",flexDirection:"column",p:1,m:1,bgcolor:"background.paper"},r.a.createElement("h2",null,"SLE Job Report"),r.a.createElement(C,{clientId:"27475518606-8bkoo1kd27attnr63le9mqur08314b0r.apps.googleusercontent.com",apiKey:""}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(x,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[58,1,2]]]);
//# sourceMappingURL=main.a8658c3e.chunk.js.map