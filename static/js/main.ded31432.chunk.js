(this["webpackJsonpjob-report-react"]=this["webpackJsonpjob-report-react"]||[]).push([[0],{58:function(e,t,n){e.exports=n(69)},63:function(e,t,n){},67:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(8),o=n.n(l),c=(n(63),n(33)),i=n(115),u=n(118),s=n(117),m=(n(67),n(41)),f=n(114),p=n(111),d=n(113),E=n(108),g=n(110),h=n(112),v=n(106),b=n(116),y=n(109),S=n(104),k=Object(S.a)((function(e){return{table:{minWidth:300,maxWidth:700},container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:200}}})),w=function(e){var t=e.record,n=e.staff_list,l=k(),o=Object(a.useState)(function(){var e=new Date,t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDay()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(a)}()),c=Object(m.a)(o,2),i=c[0],u=c[1];return r.a.createElement("div",null,r.a.createElement(s.a,{display:"flex",justifyContent:"center"},r.a.createElement("form",{className:l.container,noValidate:!0},r.a.createElement(b.a,{id:"date",label:"ORDER DATE",type:"date",value:i,className:l.textField,onChange:function(e){return function(e){u(e.target.value)}(e)},InputLabelProps:{shrink:!0}}))),r.a.createElement(g.a,{component:y.a},r.a.createElement(s.a,{display:"flex",justifyContent:"center"},r.a.createElement(p.a,{className:l.table,size:"small"},r.a.createElement(h.a,null,r.a.createElement(v.a,null,r.a.createElement(E.a,null,"Staff Name"),r.a.createElement(E.a,null,"No of Response"))),r.a.createElement(d.a,null,function(){var e=t.slice(1,t.length).filter((function(e){return function(e,t){try{var n=new Date(e);n.setHours(0,0,0,0);var a=new Date(t);return a.setHours(0,0,0,0),n.getTime()===a.getTime()}catch(r){throw r}}(e[1],i)})),a=n.map((function(e){return{name:e,response:0}}));e.forEach((function(e){a.forEach((function(t){t.name===e[2]&&t.response++}))})),a.sort((function(e,t){return t.response-e.response}));var l=(100*a.filter((function(e){return e.response>0})).length/a.length).toFixed(2);return a.unshift({name:"Response Rate",response:"".concat(l,"%")}),a.map((function(e){return r.a.createElement(v.a,{key:e.name},r.a.createElement(E.a,null,e.name),r.a.createElement(E.a,null,e.response))}))}())))))},j=function(e){var t=e.id,n=e.report_range,l=e.staff_list_range,o=Object(a.useState)(!1),i=Object(m.a)(o,2),s=i[0],p=i[1];return r.a.createElement("div",null,r.a.createElement(u.a,{onClick:function(){return p(!s)}},"Reload Data"),r.a.createElement(c.a,{range:l,id:t},(function(e){var a=e.loading,l=e.error,o=e.data;return a?r.a.createElement("div",null,r.a.createElement(f.a,null),r.a.createElement("h5",null,"Getting Staff List from Google Sheet")):l?r.a.createElement("p",null,JSON.stringify(l,null,2)):o?r.a.createElement(c.a,{id:t,range:n},(function(e){var t=e.loading,n=e.error,a=e.data;return t?r.a.createElement("div",null,r.a.createElement(f.a,null),r.a.createElement("h5",null,"Getting Job Report from Google Sheet")):n?r.a.createElement("p",null,JSON.stringify(n,null,2)):a?r.a.createElement(w,{record:a,staff_list:o.map((function(e){return e[0]}))}):r.a.createElement("p",null,"No Job Report Data")})):r.a.createElement("p",null,"No Staff List Data")})))},N=n(22),O=n(23),D=n(24),x=n(25),C=function(e){Object(x.a)(n,e);var t=Object(D.a)(n);function n(e){var a;return Object(N.a)(this,n),(a=t.call(this,e)).state={hasError:!1},a}return Object(O.a)(n,[{key:"componentDidCatch",value:function(e,t){console.log(e),console.log(t)}},{key:"render",value:function(){return this.state.hasError?r.a.createElement("h1",null,"Something went wrong."):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),n}(r.a.Component),R=function(e){var t=e.clientId,n=e.apiKey;return r.a.createElement(c.b,{clientId:t,apiKey:n},(function(e){var t=e.authorize,n=e.loading,a=e.signout,l=e.signedIn,o=e.error;return r.a.createElement("div",null,n?r.a.createElement(i.a,null):o?r.a.createElement("div",null,JSON.stringify(o,null,2)):l?r.a.createElement(u.a,{variant:"contained",color:"secondary",onClick:a},"Sign Out"):r.a.createElement(u.a,{variant:"contained",color:"primary",onClick:t},"Authorize"),l&&r.a.createElement(j,{staff_list_range:"Staff_List!A1:A",report_range:"\u8868\u55ae\u56de\u61c9 1!A1:AN",id:"1R9ti3zfqMCA9Cq3JjZAlfkIGMh6iC3atIlXN6aNKq8E"}))}))};var A=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(C,null,r.a.createElement(s.a,{display:"flex",flexDirection:"column",p:1,m:1,bgcolor:"background.paper"},r.a.createElement("h2",null,"SLE Job Report"),r.a.createElement(R,{clientId:"27475518606-8bkoo1kd27attnr63le9mqur08314b0r.apps.googleusercontent.com",apiKey:""}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[58,1,2]]]);
//# sourceMappingURL=main.ded31432.chunk.js.map